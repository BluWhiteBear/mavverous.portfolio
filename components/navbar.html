<header>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">            <a class="navbar-brand home-link" href="index.html" id="brand-link">
                <img src="resources/images/logo.png" alt="Logo" class="logo-img" width="30" height="30" style="padding-right: 10px;">
                MAVVEROUS
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link home-link" href="index.html" data-path="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link gallery-link" href="pages/gallery.html" data-path="gallery.html">Gallery</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link about-link" href="#about" data-path="#about">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link contact-link" href="#contact" data-path="#contact">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<script>
    // This script is managed by components-loader.js
    document.addEventListener('DOMContentLoaded', function() {
        // Get current location and determine if we're in a subfolder
        const currentPath = window.location.pathname.toLowerCase();
        const isSubPage = currentPath.includes('/pages/');
        
        // Get navigation elements
        const brandLink = document.getElementById('brand-link');
        const logoImg = document.querySelector('.logo-img');
        const navLinks = document.querySelectorAll('.nav-link');
        
        // Set the correct path for the logo
        logoImg.src = isSubPage ? '../resources/images/logo.png' : 'resources/images/logo.png';
        
        // Set the correct home link
        brandLink.href = isSubPage ? '../index.html' : 'index.html';
        
        // Set active class and proper links for navigation items
        navLinks.forEach(link => {
            const pathAttr = link.getAttribute('data-path');
            
            if (!pathAttr) return;
            
            // Handle Home link
            if (pathAttr === 'index.html') {
                link.href = isSubPage ? '../index.html' : 'index.html';
                
                // Set active state for home page
                if (currentPath.endsWith('index.html') || 
                    currentPath.endsWith('/') || 
                    currentPath === '/') {
                    link.classList.add('active');
                }
            }
            // Handle Gallery link
            else if (pathAttr === 'gallery.html') {
                link.href = isSubPage ? './gallery.html' : 'pages/gallery.html';
                
                // Set active state for gallery and artwork pages
                if (currentPath.includes('gallery.html') || 
                    currentPath.includes('artwork-detail.html')) {
                    link.classList.add('active');
                }
            }
            // Handle section links on home page (about, contact, etc)
            else if (pathAttr.startsWith('#')) {
                // If on home page, link to section directly
                if (currentPath.endsWith('index.html') || 
                    currentPath.endsWith('/') || 
                    currentPath === '/') {
                    link.href = pathAttr;
                    
                    // Check if this section is currently in view (for active state)
                    const sectionId = pathAttr.substring(1);
                    const section = document.getElementById(sectionId);
                    if (section && isElementInViewport(section)) {
                        link.classList.add('active');
                    }
                } else {
                    // If on another page, link back to home page with anchor
                    link.href = isSubPage ? `../index.html${pathAttr}` : `index.html${pathAttr}`;
                }
            }
        });
        
        // Helper function to check if an element is in viewport
        function isElementInViewport(el) {
            const rect = el.getBoundingClientRect();
            return (
                rect.top >= 0 &&
                rect.left >= 0 &&
                rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
                rect.right <= (window.innerWidth || document.documentElement.clientWidth)
            );
        }
        
        // Listen for scroll events to update active state on home page
        if (currentPath.endsWith('index.html') || 
            currentPath.endsWith('/') || 
            currentPath === '/') {
            
            window.addEventListener('scroll', function() {
                // Check each section that has a nav link
                ['works', 'about', 'contact'].forEach(sectionId => {
                    const section = document.getElementById(sectionId);
                    const link = document.querySelector(`.nav-link[data-path="#${sectionId}"]`);
                    
                    if (section && link) {
                        const rect = section.getBoundingClientRect();
                        const isInView = rect.top <= 150 && rect.bottom >= 150;
                        
                        if (isInView) {
                            navLinks.forEach(l => l.classList.remove('active'));
                            link.classList.add('active');
                        }
                    }
                });
            });
        }
    });
</script>
